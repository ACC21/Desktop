global adobeReader
global adobeAcrobatPro
global preview
set adobeReader to "com.adobe.reader"
set adobeAcrobatPro to "com.adobe.Acrobat.Pro"
set preview to "com.apple.preview"

if pdfReaderPath is not equal to null then
	try
		set prefferedApp to bundle identifier of (info for (path to application pdfReaderPath)) as text
	on error
		set prefferedApp to adobeAcrobatPro
	end try
else
	set prefferedApp to adobeAcrobatPro
end if

if IsInstalled(prefferedApp) and IsSupported(prefferedApp) then
	openOnPage(prefferedApp)
else if IsInstalled(adobeAcrobatPro) then
	openOnPage(adobeAcrobatPro)
else if IsInstalled(adobeReader) then
	openOnPage(adobeReader)
else if IsInstalled(preview) then
	openOnPage(preview)
end if

on IsSupported(bundleInfo)
	if bundleInfo = adobeReader or bundleInfo = adobeAcrobatPro or bundleInfo = preview then
		return true
	end if
	return false
end IsSupported

on openOnPage(bundleInfo)
	tell application "Finder"
		set pdfApp to get name of application file id bundleInfo
		open pdfPath using application file id bundleInfo
	end tell
	
	tell application pdfApp to activate
	tell application "System Events"
		if bundleInfo = adobeReader or bundleInfo = adobeAcrobatPro then
			keystroke "n" using {shift down, command down} 						
		end if
		if bundleInfo = preview then
			keystroke "g" using {option down, command down} 
		end if
		keystroke page
		keystroke return
	end tell
end openOnPage

on IsInstalled(bundleString)
	try
		tell application "Finder" to exists application file id bundleString
	on error
		false
	end try
end IsInstalled